---
import '../../styles/global.css';
import Layout from '../../components/Layout.astro';
import Breadcrumb from '../../components/Breadcrumb.astro';
import { getCollection } from 'astro:content';
import { getTranslations } from '../../content/translations';

const t = getTranslations('ko');
const lang = 'ko';

// Get all notices sorted by date (most recent first)
const allNotices = await getCollection('notices');
const notices = allNotices
	.map(n => n.data)
	.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

const pageTitle = '회사 공고';
const pageDescription = '주식회사 오믹스에이아이의 공식 공고 및 발표';
---

<Layout lang="ko" title={`${pageTitle} - ${t.meta.title}`} description={pageDescription} currentPage="resources" lightHeader={false}>
	<!-- Hero Section -->
	<section class="bg-section-alt py-16">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<Breadcrumb lang={lang} items={[
				{ name: t.nav.resources, url: '/ko/resources' },
				{ name: pageTitle, url: '/ko/notices' }
			]} />
			<div class="text-center">
				<h1 class="text-3xl md:text-4xl text-heading mb-3 animate-fade-in-up">
					{pageTitle}
				</h1>
				<p class="text-lg text-body animate-fade-in-up animate-delay-200">
					{pageDescription}
				</p>
			</div>
		</div>
	</section>

	<!-- Notices List -->
	<section class="bg-section py-12">
		<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="space-y-8">
				{notices.map((notice) => (
					<article class="glass-card rounded-2xl overflow-hidden">
						<!-- Notice Header -->
						<div class="bg-[var(--brand-teal)]/10 border-b border-subtle px-6 py-4">
							<div class="flex flex-wrap items-center justify-between gap-2">
								<h2 class="text-xl font-semibold text-heading">{notice.title[lang]}</h2>
								<div class="flex items-center gap-3">
									{notice.active && (
										<span class="px-3 py-1 text-xs font-medium bg-[var(--brand-teal)] text-white rounded-full">
											현재
										</span>
									)}
									<time class="text-sm text-muted">{notice.dateDisplay[lang]}</time>
								</div>
							</div>
						</div>

						<!-- Notice Content -->
						<div class="px-6 py-5 text-body text-sm leading-relaxed">
							<p class="mb-4">{notice.intro[lang]}</p>

							<ol class="list-decimal list-inside space-y-2 mb-5">
								{notice.items.map((item) => (
									<li><span class="text-muted">{item.label[lang]}:</span> {item.value[lang]}</li>
								))}
							</ol>

							<div class="pt-4 border-t border-subtle text-muted text-xs">
								<p>{notice.signature[lang]}</p>
							</div>
						</div>
					</article>
				))}
			</div>

			{notices.length === 0 && (
				<div class="text-center py-16">
					<p class="text-muted text-lg">현재 공고가 없습니다.</p>
				</div>
			)}
		</div>
	</section>
</Layout>
