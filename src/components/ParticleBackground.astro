---
// Particle Background Component using tsparticles
// Creates an animated particle network with mouse interaction
---

<div id="particles-container"></div>

<style>
	#particles-container {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: 0;
		pointer-events: none;
	}
</style>

<script>
	import { tsParticles } from "@tsparticles/engine";
	import { loadSlim } from "@tsparticles/slim";

	// Theme-aware color configs
	const darkColors = {
		particles: ["#31c27c", "#1ea4a1", "#1a5fbe"],
		links: "#1ea4a1",
		linksOpacity: 0.2,
		twinkle: "#ffffff",
	};

	const lightColors = {
		particles: ["#16a34a", "#0d9488", "#2563eb"],
		links: "#0d9488",
		linksOpacity: 0.2,
		twinkle: "#1ea4a1",
	};

	function getColors() {
		const isLight = document.documentElement.getAttribute("data-theme") === "light";
		return isLight ? lightColors : darkColors;
	}

	async function initParticles() {
		await loadSlim(tsParticles);
		const colors = getColors();

		const container = await tsParticles.load({
			id: "particles-container",
			options: {
				fullScreen: false,
				background: {
					color: {
						value: "transparent",
					},
				},
				fpsLimit: 60,
				particles: {
					number: {
						value: 180,
						density: {
							enable: true,
						},
					},
					color: {
						value: colors.particles,
					},
					shape: {
						type: "circle",
					},
					opacity: {
						value: 0.5,
						random: {
							enable: true,
							minimumValue: 0.2,
						},
					},
					size: {
						value: 2,
						random: {
							enable: true,
							minimumValue: 1,
						},
					},
					links: {
						enable: true,
						distance: 100,
						color: colors.links,
						opacity: colors.linksOpacity,
						width: 1,
					},
					move: {
						enable: true,
						speed: {
							min: 0.1,
							max: 0.8,
						},
						direction: "none",
						random: true,
						straight: false,
						outModes: {
							default: "out",
						},
					},
					twinkle: {
						particles: {
							enable: true,
							frequency: 0.01,
							opacity: 1,
							color: {
								value: colors.twinkle,
							},
						},
					},
				},
				interactivity: {
					detectsOn: "window",
					events: {
						onHover: {
							enable: true,
							mode: ["grab", "connect"],
						},
						resize: {
							enable: true,
						},
					},
					modes: {
						grab: {
							distance: 220,
							links: {
								opacity: 1.0,
								color: "#ff9900",
                                blink: true,
                                consent: true,
							},
						},
						connect: {
							distance: 190,
							links: {
								opacity: 0.3,
							},
							radius: 160,
						},
					},
				},
				detectRetina: true,
			},
		});

	}

	// Initialize when DOM is ready
	if (document.readyState === "loading") {
		document.addEventListener("DOMContentLoaded", initParticles);
	} else {
		initParticles();
	}
</script>
